# 遵义会议纪念馆APP应用

针对的用户群体是现场参观的群体和线上云观展的群体。为现场参观的群体提供实时语音讲解服务、导览服务、展品介绍服务等，丰富补充这类群体线下参观的不足。为线上云观展的群体提供展品在线参观服务、展览回放服务、资料查看服务等，方便这类群体足不出户也可以体验到纪念馆所能传达的教育意义。

#### 体验

[APK下载](http://footprint.cn-sh2.ufileos.com/zyhy_v1.0_debug.apk)


#### 截图
<img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-4a2224fd-4003-4b8c-b165-abef8c34b228/c5464c55-8607-4c36-b4f6-245159b9f0f9.jpg" alt="图片替换文本" width="180" height="360" align="bottom" /><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-4a2224fd-4003-4b8c-b165-abef8c34b228/0d7b01be-2ac6-4ac1-ae77-585b34f11891.jpg" alt="图片替换文本" width="180" height="360" align="bottom" /><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-4a2224fd-4003-4b8c-b165-abef8c34b228/3898708b-a71b-4f1c-b961-ddb86f67a225.jpg" alt="图片替换文本" width="180" height="360" align="bottom" /><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-4a2224fd-4003-4b8c-b165-abef8c34b228/0f5137fe-d692-46a0-9a1a-c37d77b0ccd0.jpg" alt="图片替换文本" width="180" height="360" align="bottom" /><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-4a2224fd-4003-4b8c-b165-abef8c34b228/4eec686b-fff5-466a-b85e-6097b4e53e50.jpg" alt="图片替换文本" width="180" height="360" align="bottom" /><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-4a2224fd-4003-4b8c-b165-abef8c34b228/f9ea5948-b5d4-4816-ae7f-a3b3a98b6de8.jpg" alt="图片替换文本" width="180" height="360" align="bottom" /><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-4a2224fd-4003-4b8c-b165-abef8c34b228/995ed0aa-2374-46e1-af3a-f55d4a61c26d.jpg" alt="图片替换文本" width="180" height="360" align="bottom" /><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-4a2224fd-4003-4b8c-b165-abef8c34b228/2704ddc4-e95f-4e0c-aec1-9c2093210a93.jpg" alt="图片替换文本" width="180" height="360" align="bottom" /><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-4a2224fd-4003-4b8c-b165-abef8c34b228/3bade69c-ce19-4829-9002-539c0b47d78e.jpg" alt="图片替换文本" width="180" height="360" align="bottom" /><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-4a2224fd-4003-4b8c-b165-abef8c34b228/c31c3b85-065c-4a06-a8d3-de3768868f2e.jpg" alt="图片替换文本" width="180" height="360" align="bottom" /><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-4a2224fd-4003-4b8c-b165-abef8c34b228/6429ee6b-e38c-4448-b4c6-60dfcc40c8dc.jpg" alt="图片替换文本" width="180" height="360" align="bottom" /><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-4a2224fd-4003-4b8c-b165-abef8c34b228/2f0376d2-dee5-446c-9a76-8d9170a00e4a.jpg" alt="图片替换文本" width="180" height="360" align="bottom" /><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-4a2224fd-4003-4b8c-b165-abef8c34b228/3d74245d-11dc-4503-bb5f-f4f701ac1626.jpg" alt="图片替换文本" width="180" height="360" align="bottom" /><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-4a2224fd-4003-4b8c-b165-abef8c34b228/1b5edf40-c9cd-4769-bd4c-bdfa9b6c3547.jpg" alt="图片替换文本" width="180" height="360" align="bottom" /><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-4a2224fd-4003-4b8c-b165-abef8c34b228/77ec05c6-7459-462c-8615-cb383e068a78.jpg" alt="图片替换文本" width="180" height="360" align="bottom" /><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-4a2224fd-4003-4b8c-b165-abef8c34b228/102bdadb-56d5-4777-b20f-545400b5289e.jpg" alt="图片替换文本" width="180" height="360" align="bottom" /><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-4a2224fd-4003-4b8c-b165-abef8c34b228/9e95e369-ae4d-47ef-97e6-0a011b237c81.jpg" alt="图片替换文本" width="180" height="360" align="bottom" /><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-4a2224fd-4003-4b8c-b165-abef8c34b228/3f2ee9b8-5d05-4da0-bf92-157f888b7c7b.jpg" alt="图片替换文本" width="180" height="360" align="bottom" /><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-4a2224fd-4003-4b8c-b165-abef8c34b228/fcc00467-5b0d-411d-b6c1-c7d81ef35fba.jpg" alt="图片替换文本" width="180" height="360" align="bottom" /><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-4a2224fd-4003-4b8c-b165-abef8c34b228/b0cf76c9-f158-45ab-86d6-861dde39b60d.jpg" alt="图片替换文本" width="180" height="360" align="bottom" />



## 🎁更新日志

#### v0.1
* 2020-06-07 完成图片展示页面的更新，美化（也不算很美）上传按钮
* 2020-07-19 接入原生官方审核接口完成（本地审核）
* 2020-07-23 新增”了解更多“页面

#### v0.2
* 2020-08-26 修改第一版中AK以及SK暴露在代码中引起的安全问题，修改为云环境端变量，进行传参
* 2020-08-26 原生官方接口在本地调用审核图片时，图片过小失真以至于违规图不能被识别的问题---解决方案：将审核过程放在云函数，新增云函数`imgCheck`
* 2020-08-28 图片超过官方限制不能审核的问题---解决方案：接入百度云AI审核，新增云函数`get_taken`，作用是获得百度云token供本地调用



## ⌛开放计划

* 10月份国庆之前完成华为云AI的接入（主要是现在的图片一个比一个大，不得不接入了）



## 🔨安装过程
#### 1、下载源码，并开通百度智能云API
- [百度智能云](https://cloud.baidu.com/)

注册百度智能云账号，选择图像审核，新建一个应用
![](https://pcdn.wxiou.cn//20200826132425.png)


这里的AK以及SK待会要用
![](https://pcdn.wxiou.cn//20200826132625.png)

#### 2、新建小程序，选择云开发
新建一个目录，新建一个云开发项目，然后它会初始化目录结构，初始化目录后，把下载的源码和新建的项目进行替换，因为直接导入的话可能没有用


#### 3、修改配置
点击云开发，新建一个环境，名称随意


新建以后可以得到云环境id
![](https://pcdn.wxiou.cn//20200909124622.png)

填入`app.js`文件
![](https://pcdn.wxiou.cn//20200909121430.png)

在数据库中新建集合，集合名为 photos；
![](https://pcdn.wxiou.cn//20200909122632.png)

在云开发控制设置存储的权限为 仅创建者可读写 ；确保只有上传的人可以读取图片；不然你的图片每个人都能看了


在存储中新建两个目录tmp-image 和 pics   这个cloud_icons不用管，我测试用的

![](https://pcdn.wxiou.cn//20200909122432.png)



检查当前是否连接了云开发环境
![](https://pcdn.wxiou.cn//20200909122725.png)

选择云函数目录，右键 选择`上传并部署：云端安装依赖`，全部云函数都需要部署一次


来到云开发环境，可以看到部署的云函数，点击版本管理
![](https://pcdn.wxiou.cn//20200909122837.png)

点击配置(不用在意云函数名称，我懒得截图了，用了老图)
![](https://pcdn.wxiou.cn//20200826135021.png)


添加两个环境变量
* clintId : 第一步的百度云API的AK
* clientSecret : 第一步的百度云API的SK
![](https://pcdn.wxiou.cn//20200826135148.png)


调试小程序，以上步骤没问题，便可正常运行

如有问题，请提issues


## 💰关于广告

目前的版本没有加入广告



## 📭参考文档

- [云开发文档](https://developers.weixin.qq.com/miniprogram/dev/wxcloud/basis/getting-started.html)
- [百度云内容审核接口文档](https://ai.baidu.com/ai-doc/ANTIPORN/Jk3h6x8t2)


### 喜欢项目的请给个Star, 谢谢了！

